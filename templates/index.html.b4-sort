<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Tracker</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <h1>Incident Tracker</h1>

    <div class="form-container">
        <h2>Report an Incident</h2>
        <form method="POST">
	    <label for="title">Title:</label>
	    <input type="text" id="title" name="title" required>

	    <label for="description">Description:</label>
	    <textarea id="description" name="description" required></textarea>

	    <div class="form-group">
		    <label for="priority">Priority:</label>
		    <select id="priority" name="priority" required>
		        <option value="Low">Low</option>
		        <option value="Medium">Medium</option>
		        <option value="High">High</option>
  		      <option value="Critical">Critical</option>
		    </select>
	</div>

		<div class="form-group">
		    <label for="systems_affected">Systems Affected:</label>
		    <input type="text" id="systems_affected" name="systems_affected" required>
		</div>

	    <label for="resolution">Resolution:</label>
	    <textarea id="resolution" name="resolution"></textarea>

	    <label for="remarks">Remarks:</label>
	    <textarea id="remarks" name="remarks"></textarea>

            <button type="submit">Submit Incident</button>
        </form>
        {% if error_message %}
            <div style="color: red;">{{ error_message }}</div>
        {% endif %}
    </div>

    <!-- Search Form -->
    <div class="search-container">
        <h2>Search Incidents</h2>
        <form method="GET">
            <label for="search">Search by Title or Description:</label>
            <input type="text" id="search" name="search" value="{{ request.args.get('search', '') }}">
            <button type="submit">Search</button>
        </form>
    </div>

    <!-- Incident History -->
    <div class="incident-history">
        <h2>Incident History</h2>
        {% if incidents %}
            {% for incident in incidents %}
	    <div class="incident-item">
		    <h3>{{ incident.title }}</h3>
		    <p><strong>Description:</strong> {{ incident.description }}</p>
		    <p><strong>Priority:</strong> {{ incident.priority }}</p>
		    <p><strong>Systems Affected:</strong> {{ incident.systems_affected }}</p>
		    <p><strong>Resolution:</strong> {{ incident.resolution or 'N/A' }}</p>
		    <p><strong>Remarks:</strong> {{ incident.remarks or 'N/A' }}</p>
		
	        <div style="margin-top: 10px;">
		        <a href="{{ url_for('edit_incident', incident_id=incident.id) }}">Edit</a> |
 		       <a href="{{ url_for('delete_incident', incident_id=incident.id) }}" onclick="return confirm('Are you sure you want to delete this incident?');">Delete</a>
	        </div>


		</div>
            {% endfor %}
        {% else %}
            <p>No incidents found.</p>
        {% endif %}
    </div>
</body>
</html>

